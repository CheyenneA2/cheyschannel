<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chey’s Channel</title>

  <style>
    :root{
      --bg:#0b0b0c; --card:#141416; --ring:#2a2a2a; --text:#eee; --muted:#bdbdbd;
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    html,body{ height:100%; }
    body{
      min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background-color:var(--bg);                 /* fallback while JSON loads */
      background-image:url('/images/ENTER.png');  /* fallback image */
      background-position:center;
      background-size:cover;
      background-repeat:no-repeat;
      background-attachment:fixed;
      position:relative;
    }
    /* subtle dark vignette for legibility */
    body::before{
      content:""; position:fixed; inset:0; pointer-events:none;
      background: radial-gradient(1200px 600px at 70% -10%, rgba(0,0,0,.35), rgba(0,0,0,.7));
    }

    /* Inline-editable hero (shows under/behind the gate; visible in Visual Editor) */
    main.hero{
      position:relative;
      display:grid; place-items:center;
      min-height:100vh;
      text-align:center;
      padding:24px;
    }
    main.hero h1{ font-size:clamp(1.6rem, 2.5vw + 1rem, 2.4rem); margin-bottom:10px; letter-spacing:.2px; }
    main.hero p{ color:var(--muted); font-size:clamp(.95rem, .4vw + .85rem, 1.1rem); }

    /* Passcode gate overlay */
    .gate{
      position:fixed; inset:0; display:none; place-items:center; z-index:9999;
      background: rgba(0,0,0,.65);
    }
    .gate .card{
      width:min(92vw, 420px);
      background:var(--card);
      border:1px solid var(--ring);
      border-radius:16px;
      padding:24px;
      box-shadow:0 18px 45px rgba(0,0,0,.45);
      text-align:center;
    }
    .gate h2{ font-size:1.4rem; margin-bottom:8px; }
    .gate p { color:var(--muted); margin-bottom:14px; }
    .row{ display:flex; gap:10px; }
    .row input{
      flex:1; padding:12px 14px; border-radius:12px;
      border:1px solid var(--ring); background:#121214; color:var(--text);
    }
    .row button{
      padding:12px 16px; border-radius:12px; border:1px solid var(--ring);
      background:#d1d4da; color:#111; cursor:pointer;
    }
    .row button:hover{ filter:brightness(1.05); }
    .err{ margin-top:10px; color:#ff7b7b; min-height:1.1em; }

    /* Admin shortcut + footer */
    .admin-btn{
      position:fixed; left:14px; bottom:14px; z-index:10;
      padding:6px 10px; font-size:.85rem; border-radius:8px;
      border:1px solid var(--ring); background:rgba(40,40,42,.9); color:#fff; text-decoration:none;
      backdrop-filter:blur(6px);
    }
    footer{
      position:fixed; right:14px; bottom:10px; font-size:.85rem; color:var(--muted);
      text-shadow:0 1px 2px rgba(0,0,0,.35);
    }
  </style>
</head>

<!-- Map this page to your data file for Visual Editor inline highlights -->
<body data-sb-object-id="content/home.json">

  <!-- Inline-editable hero (used/visible in the Visual Editor; harmless for visitors) -->
  <main class="hero" id="hero">
    <div>
      <h1 id="home-title" data-sb-field-path="title">Chey’s Channel</h1>
      <p id="home-welcome" data-sb-field-path="welcome">Welcome to my site!</p>
    </div>
  </main>

  <!-- Passcode Gate (shown to normal visitors; auto-skipped in Visual Editor and /admin) -->
  <div id="gate" class="gate" aria-hidden="true">
    <div class="card" role="dialog" aria-modal="true" aria-labelledby="gate-title">
      <h2 id="gate-title">Enter</h2>
      <p>Please enter the passcode to view the site.</p>
      <div class="row">
        <input id="pw" type="password" inputmode="numeric" placeholder="Passcode" autocomplete="current-password" />
        <button id="go" type="button">Enter</button>
      </div>
      <div id="err" class="err"></div>
    </div>
  </div>

  <!-- Optional: quick access to CMS -->
  <a class="admin-btn" href="/admin/">4chey</a>
  <footer>© <span id="y"></span> Chey’s Channel</footer>

  <!-- Netlify Identity for CMS login -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <script>
    // ---------- CONFIG ----------
    const PASSCODE  = "0000";                // <-- change this
    const ACCESS_OK = "cc_access_ok";        // localStorage key
    const NEXT_URL  = "/Channel0.html";     // recommend renaming "Channel0.html" to this
    // ----------------------------

    const IN_EDITOR = (window.self !== window.top) || location.pathname.startsWith("/admin");
    const gate = document.getElementById("gate");
    const pw   = document.getElementById("pw");
    const go   = document.getElementById("go");
    const err  = document.getElementById("err");

    function showGate(){
      gate.style.display = "grid";
      gate.setAttribute("aria-hidden","false");
      setTimeout(() => pw && pw.focus(), 50);
    }
    function hideGate(){
      gate.style.display = "none";
      gate.setAttribute("aria-hidden","true");
    }
    function tryEnter(){
      if ((pw.value || "").trim() === PASSCODE){
        localStorage.setItem(ACCESS_OK, "1");
        hideGate();
        // Optional redirect to your first page after unlock:
        location.href = NEXT_URL;
      } else {
        err.textContent = "Incorrect passcode.";
        pw.value = "";
        pw.focus();
      }
    }

    // Wire events (only if elements exist)
    if (go) go.addEventListener("click", tryEnter);
    if (pw) pw.addEventListener("keydown", e => { if (e.key === "Enter") tryEnter(); });

    // Gate logic: skip inside Visual Editor or /admin, otherwise require passcode once per browser
    (function initGate(){
      if (IN_EDITOR) { hideGate(); return; }
      if (localStorage.getItem(ACCESS_OK) === "1") { hideGate(); return; }
      showGate();
    })();

    // Load editable content (title/welcome/bg) from /content/home.json
    (async function loadContent(){
      try{
        const res = await fetch('/content/home.json?v=' + Date.now()); // cache-bust
        if(!res.ok) return;
        const data = await res.json();

        // Text fields
        const titleEl = document.getElementById('home-title');
        const welcomeEl = document.getElementById('home-welcome');
        if (data.title && titleEl) { titleEl.textContent = data.title; document.title = data.title; }
        if (data.welcome && welcomeEl) { welcomeEl.textContent = data.welcome; }

        // Background image
        if (data.bgImage){
          document.body.style.backgroundImage = "url('" + data.bgImage + "')";
        }
      }catch(e){
        console.warn('CMS content load failed:', e);
      }
    })();

    // Nicety: current year
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>
</html>